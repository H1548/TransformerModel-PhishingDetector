# Fine-grained Phishing Email Detection using Transformer-Based Model

This project pre-trains and fine-tunes a transformer-based model to detect multiple types of phishing emails. Not only does the model's output classify emails but also provides:
- Recommended actions
- User advice 
- An AI-generated precautionary disclaimer

For pretraining, the dataset used was the openwebtext dataset, however, for fine-tuning the dataset used was sythetically generated by chatgpt 5 consisting of: 

- Phishing examples 
- legitimtate examples 
- each labled 
- 'email, label' format

The classification classes are: 

'Phishing-payment': target label is for emails that manipulate users into handing over their bank/financial details by using fake invoices, bank alerts and payment requests,
'Phishing-delivery': label is for emails that pretend to be a delivery services that is delivering a parcel, prying user information for identity theft, 
'Phishing-techsupport': label is for emails acting as a tech company offering support but are trying to steal your system's credentials,
'Phishing-job': label is for adversaries mimicking employers offering jobs, so users can enter their private details or click a malicious link, 
'Safe-work': label for legitimate work-related emails that may consist reports, matters related to projects, etc,
'Safe-personal': label for legitimate emails users receive from friends and families, 
'Safe-marketing': label for legitimate emails from businesses sell their services, 
'Safe-transactional': label for legitimate emails for confirmed purchases made by the user, shipping updates or receipts

## Output Structure
When the final model is prompted with an input email, the model predicts a class, a function is then used in the prompt code to collect information from the 'advice.json' with respect to the predicted class. 
The final output from the phishing detector is structured as:
- phishing-credential
- recommended_action: Do not click links or enter credentials; report and delete.
- user_advice: Access accounts by typing the official URL or using a trusted app/bookmark. If you interacted, immediately change your password on the real site and revoke any suspicious sessions/MFA methods.
- ai-disclaimer: Note: This recommendation was generated by an AI system. Please follow the company's security policy if unsure.

# Features
- Phishing Detector
- MultiClass Classifiction
- Sythetic email generation script
- Transformer-based model pretrained and fine-tuned from scrath using **Pytorch** 
- Pretraining code uses Masked Language Modelling (MLM) from BERT

# Installation
## Clone the repository
<pre> '''bash git clone https://github.com/H1548/TransformerModel-PhishingDetector.git''' </pre>
<pre> '''bash cd TransformerModel-PhishingDetector'''</pre>

## Install dependencies
<pre> '''bash pip install -r requirements.txt''' </pre>

# Usage
